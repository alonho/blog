
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>A hardware lesson for software developers: from logical gates to the game of life - Alon Horev</title>
  <meta name="author" content="Alon Horev">

  
  <meta name="description" content="A week ago I&#8217;ve decided to learn VHDL and as an exercise, implement The game of life.
VHDL is a hardware description language. Basically, it&# &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://alon.horev.net/blog/2012/12/03/a-hardware-lesson-for-software-developers-from-logical-gates-to-the-game-of-life/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Alon Horev" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Alon Horev</a></h1>
  
    <h2>My stderr about Python, Databases and the web.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:alon.horev.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">A Hardware Lesson for Software Developers: From Logical Gates to the Game of Life</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-03T23:04:00+02:00" pubdate data-updated="true">Dec 3<span>rd</span>, 2012</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>A week ago I&#8217;ve decided to learn VHDL and as an exercise, implement <a href="http://en.wikipedia.org/wiki/Conway's_Game_of_Life">The game of life</a>.<br/>
VHDL is a hardware description language. Basically, it&#8217;s a programming language used by chip designers.</p>

<p><strong>Why learn VHDL?</strong><br/>
I thought it&#8217;d be interesting to see what it takes to program a chip. Coming from software, I was specifically curious about the programming model and mindset. Think about it, all software eventually translates to cpu instructions. What&#8217;s underneath that?..</p>

<p>It&#8217;s my belief that every programmer should be familiar with the layers he relies on.<br/>
Not every Python programmer knows C, and not every C programmer knows assembler. But when the shit hits the fan, this knowledge comes in handy.</p>

<p><strong>Required knowledge</strong><br/>
I&#8217;m going to assume you know nothing about hardware and a little about software.<br/>
VHDL is based on Ada so you might even find it familiar.</p>

<h2>Booleans all the way down</h2>

<p>Most hardware these days is based on boolean logic, here&#8217;s why:</p>

<ul>
<li>Boolean algebra has been around for ages - simple boolean operations like &#8216;and&#8217;, &#8216;or&#8217; and &#8216;not&#8217; can compose incredibly sophisticated algorithms (calculators, modems, CPUs!).</li>
<li>Passing boolean data is easy in hardware, you pass electricity through a wire to indicate a <strong>true</strong> state and stop passing electricity to indicate a <strong>false</strong> state.</li>
</ul>


<p><strong>Light bulb moment: ever wondered why integers in software are powers of two?</strong><br/>
A CPU has a fixed amount of wires (32/64) dedicated to represent data (a.k.a word size).<br/>
Each wire represents a bit that can be true or false (1 or 0).<br/>
The binary numeral system is used to represent a number in a bunch of 1s and 0s.</p>

<h2>Dive into VHDL - the life of a gate</h2>

<p>Let&#8217;s start off with an implementation of an &#8216;and&#8217; gate:</p>

<figure class='code'><figcaption><span>And Gate  (and.vhdl)</span> <a href='/downloads/code/and.vhdl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='vhdl'><span class='line'><span class="k">library</span> <span class="nn">ieee</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">ieee.std_logic_1164.all</span><span class="p">;</span>    
</span><span class='line'>
</span><span class='line'><span class="k">entity</span> <span class="nc">and_entity</span> <span class="k">is</span>
</span><span class='line'>  <span class="k">port</span><span class="p">(</span> 
</span><span class='line'>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic</span><span class="p">;</span>
</span><span class='line'>    <span class="n">result</span><span class="o">:</span> <span class="k">out</span> <span class="kt">std_logic</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'><span class="k">end</span> <span class="nc">and_entity</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">architecture</span> <span class="nc">arch</span> <span class="k">of</span> <span class="nc">and_entity</span> <span class="k">is</span>
</span><span class='line'><span class="k">begin</span>
</span><span class='line'>  <span class="n">result</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="k">and</span> <span class="n">y</span><span class="p">;</span>
</span><span class='line'><span class="k">end</span> <span class="nc">arch</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>What&#8217;s happening in the code line by line:</p>

<p>1-2: Include the module that exports the std_logic type which represents a bit (can be 0 or 1).<br/>
4: Define a new entity. <strong>An entity is analogous to an object in object oriented programming</strong>.<br/>
5: The entity interacts with other entities using ports. Input ports are used to receive information and output ports are used to send information.<br/>
6: Define two inputs of type std_logic.<br/>
7: Define one output of type std_logic.<br/>
11: The architecture is the implementation of the object&#8217;s behavior. It&#8217;s name (arch) is redundant as only one architecture is allowed.<br/>
13: The implementation of an &#8216;and&#8217; gate. <strong>Every time</strong> an input changes the output is recalcualted.</p>

<p>By using a synthesis tool we can convert this code to a hardware schematic:</p>

<p><img src="/images/vhdl_post/and.png" title="Schematic of the 'and' component" ></p>

<h2>Think parallel - a simple adder</h2>

<p>We&#8217;ll implement an adder that takes two bit-sized inputs (x and y) and adds them to a two-bit output (sum_0 and sum_1. sum_1 is the carry).
The following table demonstrates the adder&#8217;s functionality:</p>

<table>
    <tr>
        <th width="60">x</th>
        <th width="60">y</th>
        <th width="60">sum_1</th>
        <th width="60">sum_0</th>
        <th width="140">sum as binary</th>
        <th width="140">sum as int</th>
    </tr>
    <tr>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
        <td>0</td>
    </tr>
    <tr>
        <td>0</td>
        <td>1</td>
        <td>0</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>1</td>
        <td>0</td>
        <td>0</td>
        <td>1</td>
        <td>1</td>
        <td>1</td>
    </tr>
    <tr>
        <td>1</td>
        <td>1</td>
        <td>1</td>
        <td>0</td>
        <td>10</td>
        <td>2</td>
    </tr>
</table>




<br/>


<p>Now let&#8217;s look at the code:</p>

<figure class='code'><figcaption><span>Adder  (adder.vhdl)</span> <a href='/downloads/code/adder.vhdl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='vhdl'><span class='line'><span class="k">library</span> <span class="nn">ieee</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">ieee.std_logic_1164.all</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">entity</span> <span class="nc">adder</span> <span class="k">is</span>
</span><span class='line'>  <span class="k">port</span> <span class="p">(</span>
</span><span class='line'>    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic</span><span class="p">;</span>
</span><span class='line'>    <span class="n">sum_0</span><span class="p">,</span> <span class="n">sum_1</span><span class="o">:</span> <span class="k">out</span> <span class="kt">std_logic</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'><span class="k">end</span> <span class="nc">adder</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">architecture</span> <span class="nc">arch</span> <span class="k">of</span> <span class="nc">adder</span> <span class="k">is</span>
</span><span class='line'><span class="k">begin</span>
</span><span class='line'>  <span class="n">sum_0</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="k">xor</span> <span class="n">y</span><span class="p">;</span>
</span><span class='line'>  <span class="n">sum_1</span> <span class="o">&lt;=</span> <span class="n">x</span> <span class="k">and</span> <span class="n">y</span><span class="p">;</span>
</span><span class='line'><span class="k">end</span> <span class="nc">arch</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Look at lines 13-14. When does this code execute? Is line 13 executed before line 14?<br/>
The answer is: these lines execute all the time, <strong>in parallel!</strong></p>

<blockquote><p>A major difference between software written for CPUs and VHDL is:<br/>
<strong>VHDL is concurrent by default</strong>.</p></blockquote>

<p>VHDL has the notion of <em>concurrent</em> statements vs. <em>sequential</em> statements.<br/>
Sequential statments can be used to implement state machines and other sequential procedures.</p>

<h2>Testing using sequential code</h2>

<p>The hardware manufacturing phase of a chip is long and expensive, therefore, VHDL programmers (often called designers) write tests (often called &#8216;testbenches&#8217; or &#8216;simulations&#8217;).</p>

<p>The following test code will verify the adder&#8217;s functionality by driving different inputs and verifying the output (explanation ahead):</p>

<figure class='code'><figcaption><span>Test Adder  (test_adder.vhdl)</span> <a href='/downloads/code/test_adder.vhdl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='vhdl'><span class='line'><span class="k">library</span> <span class="nn">ieee</span><span class="p">;</span>
</span><span class='line'><span class="k">use</span> <span class="nn">ieee.std_logic_1164.all</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">entity</span> <span class="nc">adder_test</span> <span class="k">is</span>
</span><span class='line'><span class="k">end</span> <span class="nc">adder_test</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">architecture</span> <span class="nc">arch</span> <span class="k">of</span> <span class="nc">adder_test</span> <span class="k">is</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">component</span> <span class="nc">adder</span> <span class="k">is</span>
</span><span class='line'>    <span class="k">port</span> <span class="p">(</span>
</span><span class='line'>      <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">:</span> <span class="k">in</span> <span class="kt">std_logic</span><span class="p">;</span>
</span><span class='line'>      <span class="n">sum_0</span><span class="p">,</span> <span class="n">sum_1</span><span class="o">:</span> <span class="k">out</span> <span class="kt">std_logic</span>
</span><span class='line'>    <span class="p">);</span>
</span><span class='line'>  <span class="k">end</span> <span class="k">component</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">signal</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sum_0</span><span class="p">,</span> <span class="n">sum_1</span><span class="o">:</span> <span class="kt">std_logic</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">begin</span>
</span><span class='line'>    <span class="n">adder_0</span><span class="o">:</span> <span class="n">adder</span> <span class="k">port</span> <span class="k">map</span> <span class="p">(</span>
</span><span class='line'>      <span class="n">x</span> <span class="o">=&gt;</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=&gt;</span> <span class="n">y</span><span class="p">,</span>
</span><span class='line'>      <span class="n">sum_0</span> <span class="o">=&gt;</span> <span class="n">sum_0</span><span class="p">,</span> <span class="n">sum_1</span> <span class="o">=&gt;</span> <span class="n">sum_1</span>
</span><span class='line'>      <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">process</span>
</span><span class='line'>    <span class="k">begin</span>
</span><span class='line'>      <span class="n">x</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="n">y</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
</span><span class='line'>      <span class="k">assert</span> <span class="n">sum_1</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span> <span class="k">and</span> <span class="n">sum_0</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span>
</span><span class='line'>        <span class="n">report</span> <span class="s">&quot;result should be 2&quot;</span> <span class="k">severity</span> <span class="n">error</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">x</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="n">y</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
</span><span class='line'>      <span class="k">assert</span> <span class="n">sum_1</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span> <span class="k">and</span> <span class="n">sum_0</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span>
</span><span class='line'>        <span class="n">report</span> <span class="s">&quot;result should be 0&quot;</span> <span class="k">severity</span> <span class="n">error</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">x</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="n">y</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
</span><span class='line'>      <span class="k">assert</span> <span class="n">sum_1</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span> <span class="k">and</span> <span class="n">sum_0</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span>
</span><span class='line'>        <span class="n">report</span> <span class="s">&quot;result should be 1&quot;</span> <span class="k">severity</span> <span class="n">error</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="n">x</span> <span class="o">&lt;=</span> <span class="sc">&#39;0&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="n">y</span> <span class="o">&lt;=</span> <span class="sc">&#39;1&#39;</span><span class="p">;</span>
</span><span class='line'>      <span class="k">wait</span> <span class="k">for</span> <span class="mi">1</span> <span class="n">ns</span><span class="p">;</span>
</span><span class='line'>      <span class="k">assert</span> <span class="n">sum_1</span> <span class="o">=</span> <span class="sc">&#39;0&#39;</span> <span class="k">and</span> <span class="n">sum_0</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span>
</span><span class='line'>        <span class="n">report</span> <span class="s">&quot;result should be 1&quot;</span> <span class="k">severity</span> <span class="n">error</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">wait</span><span class="p">;</span>
</span><span class='line'>    <span class="k">end</span> <span class="k">process</span><span class="p">;</span>
</span><span class='line'><span class="k">end</span> <span class="nc">arch</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>4: Define an entity for the test. This entity has no inputs and outputs.<br/>
9-14: Repetition of the adder&#8217;s interface (VHDL isn&#8217;t very DRY)<br/>
16: Signals are wires that the test can manipulate. their type is std_logic (a bit)<br/>
19-22: A port map connects the signals to the adder&#8217;s ports. I named the signals exactly as the adder&#8217;s ports.<br/>
24: The process definition. A process contains a list of <strong>sequential</strong> statements. Multiple processes run concurrently.<br/>
26-27: Signal assignments.<br/>
28: Signals have an interesting behavior where the assignment takes effect only when calling &#8216;wait&#8217;. This is a feature and not a bug as it allows doing atomic changes over multiple signals.<br/>
29: Assert the sum changed.<br/>
30 Until the end: Test the remaining cases.</p>

<p>Here&#8217;s the simulation in wave form:</p>

<p><img src="/images/vhdl_post/adder_test.png" width="800" height="300" title="Waveform of adder_test.vhdl" ></p>

<p><strong>Note</strong>: Some VHDL statements are not <em>synthesizable</em>, meaning they cannot be converted to hardware and can only be used for simulations.<br/>
An example is the <em>wait</em> statement. A 1 nano second sleep cannot be expressed solely by logical gates.
The solution for time-aware components is connecting to a high speed clock (Implemented using a <a href="http://en.wikipedia.org/wiki/Crystal_oscillator">Crystal oscillator</a>), we&#8217;ll see an example ahead.</p>

<h2>The game of life</h2>

<p>Let&#8217;s start with a typical software-based solution:</p>

<ol>
<li>The board is a matrix of booleans representing cells.</li>
<li>For each cycle: the next board is generated by iterating over the matrix, for each cell: count it&#8217;s neighbors and determine if it should live or die.</li>
</ol>


<p>When trying to apply this design in VHDL I quickly ran into brick walls. A sequential iteration over an entire matrix is not the VHDL &#8216;way&#8217;. My guess is that a sequential design would generate much more logical gates and perhaps even be slower.</p>

<blockquote><p>Software is often bound by memory and CPU.<br/>
Chip design is often bound by the amount of gates and timing issues which surface when signals travel through large amounts of gates.</p></blockquote>

<p>VHDL encourages you to build small components and inter-connect them where needed.<br/>
each component has it&#8217;s own hardware resources and works in parallel to others.</p>

<p>The design I came up with is the following:</p>

<ol>
<li><em>Cell</em> - Is an entity. Connected to it&#8217;s neighbors via ports. The cell waits for a clock signal, counts his live neighbors and sets it&#8217;s alive state.</li>
<li><em>Board</em> - Is another entity. Contains a matrix of cells. All it does is inter-connects them.</li>
</ol>


<p>Here&#8217;s the cell&#8217;s code:</p>

<figure class='code'><figcaption><span>Cell  (cell.vhdl)</span> <a href='/downloads/code/cell.vhdl'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='vhdl'><span class='line'><span class="k">entity</span> <span class="nc">cell</span> <span class="k">is</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">generic</span> <span class="p">(</span>
</span><span class='line'>    <span class="n">start_alive</span> <span class="o">:</span> <span class="kt">integer</span> <span class="k">range</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">1</span> <span class="o">:=</span> <span class="mi">0</span>
</span><span class='line'>  <span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">port</span> <span class="p">(</span>
</span><span class='line'>    <span class="n">clock</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span>
</span><span class='line'>    <span class="n">upper_left</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">upper_right</span><span class="p">,</span>
</span><span class='line'>    <span class="n">lower_left</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">lower_right</span> <span class="o">:</span> <span class="k">in</span> <span class="kt">integer</span> <span class="k">range</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>    <span class="n">alive</span> <span class="o">:</span> <span class="k">inout</span> <span class="kt">integer</span> <span class="k">range</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">1</span> <span class="o">:=</span> <span class="n">start_alive</span>
</span><span class='line'>  <span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span> <span class="nc">cell</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">architecture</span> <span class="nc">arch</span> <span class="k">of</span> <span class="nc">cell</span> <span class="k">is</span>
</span><span class='line'><span class="k">begin</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">process</span> <span class="p">(</span><span class="n">clock</span><span class="p">)</span>
</span><span class='line'>    <span class="k">variable</span> <span class="n">neighbors</span><span class="o">:</span> <span class="kt">integer</span> <span class="k">range</span> <span class="mi">0</span> <span class="k">to</span> <span class="mi">8</span><span class="p">;</span>
</span><span class='line'>    <span class="k">begin</span>
</span><span class='line'>      <span class="n">neighbors</span> <span class="o">:=</span> <span class="n">upper_left</span> <span class="o">+</span> <span class="n">upper</span> <span class="o">+</span> <span class="n">upper_right</span> <span class="o">+</span> <span class="n">left</span> <span class="o">+</span>
</span><span class='line'>                   <span class="n">right</span> <span class="o">+</span> <span class="n">lower_left</span> <span class="o">+</span> <span class="n">lower</span> <span class="o">+</span> <span class="n">lower_right</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="n">neighbors</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">or</span> <span class="p">(</span><span class="n">alive</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">and</span> <span class="p">(</span><span class="n">neighbors</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
</span><span class='line'>        <span class="n">alive</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">;</span>
</span><span class='line'>      <span class="k">else</span>
</span><span class='line'>        <span class="n">alive</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>      <span class="k">end</span> <span class="k">if</span><span class="p">;</span>
</span><span class='line'>    <span class="k">end</span> <span class="k">process</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span> <span class="nc">arch</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>3: Generics are variables that can be set upon entity instantiation. Somewhat similar to constructor arguments in object oriented languages.<br/>
19: Notice the process gets an argument? A process can state a list of signals (also called a sensitivity list) that should trigger it&#8217;s invocation. That way, the cell will calculate it&#8217;s next state every time the clock changes.<br/>
20: Variables are exactly what you think they. Notice we limit the integer&#8217;s range to 8? that&#8217;s because we&#8217;ll have a maximum of 8 neighbors. VHDL dedicate only 4 wires for that variable.</p>

<p><img src="/images/vhdl_post/board.png" title="Schematic of a two cell board" ></p>

<h2>Conclusions</h2>

<p><strong>Scalabillity - How the design scales for a large amount of cells?</strong></p>

<p>The software-based solution has several limits:</p>

<ul>
<li>Memory-wise: limited by the amount of memory.</li>
<li>Speed-wise: iteration is done serially and will be directly proportional to the amount of cells, even if multiple cores are utilized.</li>
</ul>


<p>The hardware-based solution is said to be scalable:</p>

<ul>
<li>Adding more cells results in adding more logical gates.</li>
<li>There is no performance overhead and no arbitrary limit on the number of cells in the matrix.</li>
</ul>


<p><strong>Change of mindset</strong><br/>
One of the most challenging concepts in software is concurreny, it&#8217;s interesting how fundamental this topic is to hardware.</p>

<blockquote><p>Software - Write serial code, parallelize when need to scale.<br/>
Hardware - Write concurrent code, write serial code where needed.</p></blockquote>

<p><strong>Why bother manufacturing new chips and not re-use CPUs?</strong><br/>
Here are a few reasons I can come up with:</p>

<ol>
<li><em>Power consumption</em> of CPUs can render them unusable for many applications (Battery size/life).</li>
<li><em>Performance</em> of ASICs (Application specific integrated circuits - chips created for a specific task) can work faster compared to CPUs (That&#8217;s why GPUs became popular).</li>
<li><em>Price</em> per unit can drop drastically for large amounts of ASICs (compare a chip that does bluetooth to an Intel CPU).</li>
</ol>


<h2>Tools</h2>

<ul>
<li>ghdl (for mac!)</li>
<li>Xilinix on windows or schematic generation</li>
<li>gtkwave along with ghdl</li>
</ul>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Alon Horev</span></span>

      








  


<time datetime="2012-12-03T23:04:00+02:00" pubdate data-updated="true">Dec 3<span>rd</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/vhdl/'>VHDL</a>, <a class='category' href='/blog/categories/crazy/'>crazy</a>, <a class='category' href='/blog/categories/hardware/'>hardware</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://alon.horev.net/blog/2012/12/03/a-hardware-lesson-for-software-developers-from-logical-gates-to-the-game-of-life/" data-via="alonhorev" data-counturl="http://alon.horev.net/blog/2012/12/03/a-hardware-lesson-for-software-developers-from-logical-gates-to-the-game-of-life/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/03/a-hardware-lesson-for-software-developers-from-logical-gates-to-the-game-of-life/">A hardware lesson for software developers: from logical gates to the game of life</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/alonho">@alonho</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'alonho',
            count: 0,
            skip_forks: true,
            blacklist: "game_of_life_vhdl, emacs_config, course, game_of_life_haskell, stuff, asserter, gold_and_hail, zilber, event_manager, python-memory-inspection".split(", "),
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("alonhorev", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/alonhorev" class="twitter-follow-button" data-show-count="false">Follow @alonhorev</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Alon Horev -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'alonho';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://alon.horev.net/blog/2012/12/03/a-hardware-lesson-for-software-developers-from-logical-gates-to-the-game-of-life/';
        var disqus_url = 'http://alon.horev.net/blog/2012/12/03/a-hardware-lesson-for-software-developers-from-logical-gates-to-the-game-of-life/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



<!--
hn like button plugin for jekyll/octopress
Author: dryman (Felix Ren-Chyan Chern)

Inpired from http://hnlike.com/ written by sbashyal

(The MIT License)

Copyright © 2012-2013 Felix Ren-Chyan Chern

Permission is hereby granted, free of charge, to any person obtaining a copy of
this software and associated documentation files (the ‘Software’), to deal in
the Software without restriction, including without limitation the rights to
use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
of the Software, and to permit persons to whom the Software is furnished to do
so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED ‘AS IS’, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
-->
  <script type="text/javascript">
    (function(){
      var hn_like = document.createElement('iframe');
      hn_like.frameborder="no";
      hn_like.scrolling="no";
      hn_like.height="28px";
      hn_like.width="115px";
      hn_like.src = "http://hnlike.com/upvote.php?link="
                    + encodeURIComponent(document.location)
                    + "&title="
                    + encodeURIComponent("A hardware lesson for software developers: from logical gates to the game of life");
      hn_like.innerHTML="iframes not supported by your browser";
      var twitter = document.getElementsByClassName("twitter-share-button")[0];

      twitter.parentNode.insertBefore(
        hn_like,
        twitter
      );
    })();
  </script>

<!-- end of hn like button -->





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
